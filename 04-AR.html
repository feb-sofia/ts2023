<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Time Series Analysis 2023/2024 - 4&nbsp; Autoregressive Processes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-Model-Fitting.html" rel="next">
<link href="./03-linear-difference-equations.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-AR.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Autoregressive Processes</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Time Series Analysis 2023/2024</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Information</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Statistics-Review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistics Review</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-linear-difference-equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear Difference Equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-AR.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Autoregressive Processes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Model-Fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ARIMA Modeling (1)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Unit-Root-Tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">DF-test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-purely-random-process" id="toc-the-purely-random-process" class="nav-link active" data-scroll-target="#the-purely-random-process"><span class="header-section-number">4.1</span> The Purely Random Process</a></li>
  <li><a href="#ar1" id="toc-ar1" class="nav-link" data-scroll-target="#ar1"><span class="header-section-number">4.2</span> AR(1)</a></li>
  <li><a href="#characteristic-roots-and-the-yule-walker-equations" id="toc-characteristic-roots-and-the-yule-walker-equations" class="nav-link" data-scroll-target="#characteristic-roots-and-the-yule-walker-equations"><span class="header-section-number">4.3</span> Characteristic Roots and the Yule-Walker equations</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Autoregressive Processes</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<p>Time series process: sequence of random variables</p>
<p><span class="math display">\[
y_1, y_2,\ldots,y_{T}
\]</span></p>
<p>For the rest of the course we will drop the distinction between the random variables (the stochastic process) and the observed values of the time series. You need to discern from the context whether we are talking about the random variables of about the values.</p>
<section id="the-purely-random-process" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="the-purely-random-process"><span class="header-section-number">4.1</span> The Purely Random Process</h2>
<p>In the last class we discussed linear difference equations and their stability. Here we will introduce randomness into the difference equation by assuming that the autonomous terms <span class="math inline">\(e_t\)</span> are uncorrelated and follow a distribution with zero mean and constant variance (not depending on the time index).</p>
<div id="def-purely-random" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.1 (The Purely Random Process) </strong></span>A stochastic process <span class="math inline">\(e_t\)</span> with the follwing three properties is called a purely random or a white noise process.</p>
<p><span class="math display">\[
\begin{align}
&amp; E(e_t) = 0 \text{ for all } t \\
&amp; Var(e_t) = \sigma^2, \sigma^2 \in \mathbb{R} \\
&amp; Cov(e_{t}, e_{t + k}) = 0, k \neq 0
\end{align}
\]</span></p>
</div>
<p>From the definitions of variance (<a href="02-Statistics-Review.html#def-variance">Definition&nbsp;<span>2.1</span></a>) and covariance (<a href="02-Statistics-Review.html#def-covariance">Definition&nbsp;<span>2.2</span></a>) you can see that the covariance between two time points is simply the expected value of the cross product of the terms, because <span class="math inline">\(E(e_t) = 0\)</span> for all <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[
Cov(e_t, e_{t + k}) = E(e_{t}e_{t + k}) = 0
\]</span></p>
<p>When <span class="math inline">\(k = 0\)</span>, this expression reduces to</p>
<p><span class="math display">\[
Cov(e_t, e_{t + 0}) = E(e_t e_t) = E(e_t^2) = \sigma^2
\]</span> How does such a process look like? It is convenient to generate random values in order to visualize it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">e =</span> <span class="fu">rnorm</span>(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The number of values to be drawn at random</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> n, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The expected value of the distribution</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="dv">0</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The standard deviation of the distribution</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="dv">2</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>dt <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> e)) <span class="sc">+</span> </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-AR_files/figure-html/purely-random-sim-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In order to see how the two parameters of the normal distribution affect the shape of the resulting series, the following code chunk shows four series:</p>
<p><span class="math display">\[
\begin{align}
e^{(1)}_t &amp; \sim N(\mu = 0, \sigma^2 = 1) \\
e^{(2)}_t &amp; \sim N(\mu = 10, \sigma^2 = 1) \\
e^{(3)}_t &amp; \sim N(\mu = 0, \sigma^2 = 3^2) \\
e^{(4)}_t &amp; \sim N(\mu = 10, \sigma^2 = 3^2)
\end{align}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For illustration only</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma_lab =</span> <span class="fu">paste0</span>(<span class="st">"sigma = "</span>, sigma),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu_lab =</span> <span class="fu">paste0</span>(<span class="st">"mu = "</span>, mu)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>sim_data <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> y, <span class="at">color =</span> mu_lab)) <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sigma_lab) <span class="sc">+</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"t"</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(y[t]),</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Expected value"</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-AR_files/figure-html/purely-random-mean-var-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sim_data <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mu_lab, sigma_lab) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Average =</span> <span class="fu">mean</span>(y),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">StdDev =</span> <span class="fu">sd</span>(y)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'mu_lab'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
# Groups:   mu_lab [2]
  mu_lab  sigma_lab Average StdDev
  &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;
1 mu = 0  sigma = 1  -0.114  1.08 
2 mu = 0  sigma = 3  -0.329  3.00 
3 mu = 10 sigma = 1  10.1    0.950
4 mu = 10 sigma = 3  10.1    2.82 </code></pre>
</div>
</div>
<p>Now that we have seen some realizations of a couple of purely random processes, let’s look at the empirical summaries of the time series.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dt<span class="sc">$</span>e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1403046</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(dt<span class="sc">$</span>e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.245328</code></pre>
</div>
</div>
<p>Let’s also compute is (empirical) auto-correlation coefficients applying the formula</p>
<p><span class="math display">\[
\hat{\rho}(k) = \frac{\hat{\gamma}(k)}{\hat{\gamma}(0)} \\
\hat{\rho}(k) = \frac{\sum_{t = 1}^{T - k}(y_t - \hat{\mu})(y_{t + k} - \hat{\mu})}{\sum_{t = 1}^{T}(y_t - \hat{\mu})}
\]</span></p>
<p>where <span class="math inline">\(\hat{\mu}\)</span> is the sample average of the series.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> dt <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">e_l1 =</span> <span class="fu">lag</span>(e, <span class="at">n =</span> <span class="dv">1</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">e_l2 =</span> <span class="fu">lag</span>(e, <span class="at">n =</span> <span class="dv">2</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">e_l3 =</span> <span class="fu">lag</span>(e, <span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dt<span class="sc">$</span>e, dt<span class="sc">$</span>e_l1, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.01228154</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dt<span class="sc">$</span>e, dt<span class="sc">$</span>e_l2, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.06602254</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dt<span class="sc">$</span>e, dt<span class="sc">$</span>e_l3, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1716531</code></pre>
</div>
</div>
<p>You can obtain these auto-correlation coefficients using the <code>acf</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(dt<span class="sc">$</span>e, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Autocorrelations of series 'dt$e', by lag

     0      1      2      3      4      5      6      7      8      9     10 
 1.000 -0.012 -0.065  0.169 -0.139  0.036  0.004 -0.089 -0.126 -0.034  0.070 
    11     12     13     14     15     16     17     18     19     20 
 0.050 -0.026 -0.035  0.140 -0.061 -0.127 -0.211 -0.223  0.074 -0.103 </code></pre>
</div>
</div>
<p>and you can visualize the auto-correlation coefficients</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(dt<span class="sc">$</span>e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-AR_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Even though the time series was generated from a process without zero correlations, the empirical auto-correlation coefficients will generally be non-zero. In order to assess whether the observed correlations are compatible with zero theoretical correlations, you can use the confidence interval</p>
<p><span class="math display">\[
0 \pm \frac{2}{\sqrt{T}}
\]</span> that is shown as the two dashed horizontal lines in the plot.</p>
<p>The Box-Ljung test is a statistical test for the hypothesis</p>
<p><span class="math display">\[
\rho_{1} = \rho_2 = \rho_{k} = 0
\]</span></p>
<p>and is based on the test statistic:</p>
<p><span class="math display">\[
Q = T(T + 2)\sum_{j = 1}^{k}\frac{\hat{\rho}^2(j)}{T - j}
\]</span> Under the null hypothesis (i.e., if we assume the null hypothesis to be true) it follows a <span class="math inline">\(\Chi^2\)</span> distribution with <span class="math inline">\(k\)</span> degrees of freedom.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(dt<span class="sc">$</span>e, <span class="at">lag =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box-Pierce test

data:  dt$e
X-squared = 3.2944, df = 3, p-value = 0.3484</code></pre>
</div>
</div>
</section>
<section id="ar1" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="ar1"><span class="header-section-number">4.2</span> AR(1)</h2>
<p>The autoregressive (AR) process of first order is defined by</p>
<p><span class="math display">\[
y_{t} = \phi_0 + \phi_1 y_{t - 1} + e_t
\]</span></p>
<p>where <span class="math inline">\(\phi_0, \phi_1 \in \mathbb{R}\)</span> are fixed (non-random) constants, and <span class="math inline">\(e_t\)</span> is a purely random process.</p>
<p>We would like to derive the statistical properties of the process (expected value, variance and correlations) from the model definitions.</p>
<p>Let’s give it a try. To derive it we use the model definition, the properties of the expected value operator from <a href="02-Statistics-Review.html#thm-exp-value-props">Theorem&nbsp;<span>2.1</span></a>, and the properties of the purely random process in <a href="#def-purely-random">Definition&nbsp;<span>4.1</span></a>. The expected value of the process is then</p>
<p><span class="math display">\[
\begin{align}
E(y_t) &amp; = E(\phi_0 + \phi_1 y_{t - 1} + e_t) \\
       &amp; = E(\phi_0) + E(\phi_1 y_{t - 1}) + E(e_t) \\
       &amp; = \phi_0 + \phi_1 E(y_{t - 1}) + 0 \\
       &amp; = \phi_0 + \phi_1 E(y_{t - 1})
\end{align}
\]</span> Now we may seem to have hit a dead end, because knowing the expected value of <span class="math inline">\(E(y_t)\)</span> requires the knowledge of <span class="math inline">\(E(y_{t - 1})\)</span>. However, if we assume that the expected value does not depend on the time index, so that</p>
<p><span class="math display">\[
E(y_t) = E(y_{t - 1}) = \mu
\]</span></p>
<p>then the equation is very easy to solve:</p>
<p><span class="math display">\[
\begin{align}
\underbrace{E(y_{t})}_{\mu} &amp; = \phi_0 + \phi_1 \underbrace{E(y_{t - 1})}_{\mu} \\
\mu &amp; = \phi_0 + \phi_1 \mu \\
(1 - \phi_1)\mu &amp; = \phi_0 \\
\mu &amp; = \frac{\phi_0}{1 - \phi_1}
\end{align}
\]</span></p>
<p>In other words</p>
<p><span id="eq-expected-value-ar-1"><span class="math display">\[
\mu = E(y_{t}) = E(y_{t - 1}) = \frac{\phi_0}{1 - \phi_1}
\tag{4.1}\]</span></span></p>
<p>This derivation begs the question: are we allowed to assume that the expected value does not change over time? The answer is yes, if the process is mean-stationary. This is just another way to say that the expected value does not change but we can derive a condition when this is the case.</p>
<p>To see how the stability condition for the first order difference equation relates to the expected value, consider the solution to the equation that we derived last time. The only new thing here is the constant term <span class="math inline">\(\phi_0\)</span>.</p>
<p><span class="math display">\[
y_{t} = \phi_1^{t} y_{0} + \frac{1 - \phi_1^{t}}{1 - \phi_1} \phi_0 + \sum_{k = 0}^{t - 1} \phi_1^{k} u_{t - k}
\]</span></p>
<div id="exr-variance-ar-1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.1 (Variance of a Stationary AR(1)) </strong></span>What is the variance of an AR(1) process given by:</p>
<p><span class="math display">\[
y_{t} = \phi_0 + \phi_1 y_{t - 1} + e_{t}, e_{t} \sim N(0, \sigma^2)
\]</span> Use the properties of the variance in <a href="02-Statistics-Review.html#thm-variance-short">Theorem&nbsp;<span>2.2</span></a> and the properties of the purely random process to derive it.</p>
<p><span class="math display">\[
Var(y_{t}) = ?
\]</span></p>
</div>
<div id="exr-ar-1-cor" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.2 (Autocorrelations of a AR(1) process) </strong></span>Express the first and second order auto-correlations of the AR(1) process in terms of its coefficients <span class="math inline">\(\phi_0\)</span> and <span class="math inline">\(\phi_1\)</span>. Without a loss of generality, assume that the process has a zero expected value.</p>
</div>
<p>The derivation of the autocorrelations of MA(q) processes was relatively easy. For AR(1) processes you can derive the Yule-Walker equations that link the model coefficients and the autocovariances (and therefore the autocorrelations).</p>
<p>Without a loss of generality, assume that the constant in the process is zero: <span class="math inline">\(\phi_0 = 0\)</span>. This implies that the expected value of the process is zero (see <a href="#eq-expected-value-ar-1">Equation&nbsp;<span>4.1</span></a>):</p>
<p><span class="math display">\[
\phi_0 = 0 \implies \mu = E(y_t) = E(y_{t - k}) = 0 \text{ for all } k
\]</span></p>
<p>For a variable with zero expected value the variance and covariances are simply the expected value of the the cross-products (see <a href="02-Statistics-Review.html#thm-variance-short">Theorem&nbsp;<span>2.2</span></a>).</p>
<p><span class="math display">\[
\begin{align}
&amp; Cov(y_t, y_{t - k}) = E(y_t y_{t - k}) \\
&amp; Var(y_{t}) = Cov(y_t, y_{t - 0}) = E(y_t y_{t}) = E(y_t^2) \\
\end{align}
\]</span> Now it is very easy to compute the covariance: just take the process definition for a AR(1) and multiply both sides of the equation by <span class="math inline">\(y_{t - k}\)</span></p>
<p><span class="math display">\[
\begin{align}
y_{t} &amp; = \phi_1 y_{t - 1} + e_t \\
y_{t - k}y_{t} &amp; = \phi_1 y_{t - k} y_{t -1} + y_{t - k} e_t
\end{align}
\]</span> Now take the expectation on both sides of the equation and apply the properties of the expected value from <a href="02-Statistics-Review.html#thm-exp-value-props">Theorem&nbsp;<span>2.1</span></a>.</p>
<p><span class="math display">\[
\begin{align}
E(y_{t - k}y_{t}) &amp; = E(\phi_1 y_{t - k} y_{t -1} + y_{t - k} e_t) \\
&amp; = \phi_1 E(y_{t - k}y_{t - 1}) + E(y_{t - k}e_t)
\end{align}
\]</span> Now there is only one crucial thing that you must realize. The last expected value in the equation is a product of <span class="math inline">\(y_{t - k}\)</span> and <span class="math inline">\(e_{t}\)</span>. It is zero for all <span class="math inline">\(k &gt; 0\)</span> but it equals <span class="math inline">\(\sigma^2\)</span> for <span class="math inline">\(k=0\)</span>. Why? Let’s write it down for <span class="math inline">\(k = 0\)</span>.</p>
<p><span id="eq-yule-walker-ar-1-gen"><span class="math display">\[
\begin{align}
E(y_{t - 0}e_t) = E(y_t e_t) &amp; = E\left((\phi_1 y_{t - 1} + e_t) e_t \right) \\
&amp; = E(\phi_1 y_{t - 1} e_t + e_t^2) \\
&amp; = \phi_1 E(y_{t - 1} e_t) + E(e_t^2) \\
&amp; = \phi_1 E(y_{t - 1} e_t) + Var(e_t) \\
&amp; = \phi_1 E(y_{t - 1} e_t) + \sigma^2 \\
\end{align}
\tag{4.2}\]</span></span></p>
<p>Now keep in mind that <span class="math inline">\(y_{t - 1}\)</span> depends only on values of <span class="math inline">\(e_t\)</span> that occur before <span class="math inline">\(t\)</span>, so it must have zero covariance with <span class="math inline">\(e_{t}\)</span></p>
<p><span class="math display">\[
y_{t - 1} = \phi_1 y_{t - 2} + e_{t - 1}
\]</span></p>
<p>and therefore</p>
<p><span class="math display">\[
E(y_{t - 1}e_{t}) = 0
\]</span></p>
<p>The same also holds for the process variables before <span class="math inline">\(t - 1\)</span> such as <span class="math inline">\(y_{t - k}\)</span>.</p>
<p>Therefore we can express <a href="#eq-yule-walker-ar-1-gen">Equation&nbsp;<span>4.2</span></a> as</p>
<p><span class="math display">\[
E(y_{t - k}y_{t}) = \phi_1 E(y_{t - k}y_{t - 1}) + \unicode{x1D7D9}_{k = 0}\sigma^2
\]</span> To simplify the notation a little bit, we will use the symbols for the autocovariances and autocorrelations defined in <a href="02-Statistics-Review.html#def-autocorrelations">Definition&nbsp;<span>2.4</span></a>.</p>
<p><span class="math display">\[
\begin{align}
\gamma(k) = \phi_1 \gamma(k - 1) + \unicode{x1D7D9}_{k = 0}\sigma^2
\end{align}
\]</span> Now we can write the equation for several values of <span class="math inline">\(k\)</span>:</p>
<p><span class="math display">\[
\begin{align}
&amp; k = 0: \gamma(0) = \phi_1 \gamma(0 - 1) + \sigma^2 \\
&amp; k = 1: \gamma(1) = \phi_1 \gamma(1 - 1) + 0 \\
&amp; k = 2: \gamma(2) = \phi_1 \gamma(2 - 1) + 0 \\
&amp; k = 3: \gamma(3) = \phi_1 \gamma(3 - 1) + 0 \\
\end{align}
\]</span> Simplifying a bit:</p>
<p><span class="math display">\[
\begin{align}
&amp; k = 0: \gamma(0) = \phi_1 \gamma(- 1) + \sigma^2 \\
&amp; k = 1: \gamma(1) = \phi_1 \gamma(0) \\
&amp; k = 2: \gamma(2) = \phi_1 \gamma(1) \\
&amp; k = 3: \gamma(3) = \phi_1 \gamma(2) \\
\end{align}
\]</span> Now you need one final bit to complete the Yule-Walker equations. The autocovariances are symmetric, i.e.&nbsp;<span class="math inline">\(\gamma(-k) = \gamma(k)\)</span>. So finally:</p>
<p><span class="math display">\[
\begin{align}
&amp; k = 0: \gamma(0) = \phi_1 \gamma(1) + \sigma^2 \\
&amp; k = 1: \gamma(1) = \phi_1 \gamma(0) \\
&amp; k = 2: \gamma(2) = \phi_1 \gamma(1) \\
&amp; k = 3: \gamma(3) = \phi_1 \gamma(2) \\
\end{align}
\]</span> You can obtain the autocorrelations easily by dividing each equation by the variance of the process <span class="math inline">\(\gamma(0)\)</span></p>
<p><span class="math display">\[
\begin{align}
&amp; k = 0: \gamma(0) = \phi_1 \gamma(1) + \sigma^2 \\
&amp; k = 1: \gamma(1) = \phi_1 \gamma(0) \\
&amp; k = 2: \gamma(2) = \phi_1 \gamma(1) \\
&amp; k = 3: \gamma(3) = \phi_1 \gamma(2) \\
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
&amp; k = 0: \gamma(0) = \phi_1 \gamma(1) + \sigma^2 \quad / \gamma(0)\\
&amp; k = 1: \gamma(1) = \phi_1 \gamma(0)  \quad / \gamma(0) \\
&amp; k = 2: \gamma(2) = \phi_1 \gamma(1)  \quad / \gamma(0)\\
&amp; k = 3: \gamma(3) = \phi_1 \gamma(2)  \quad / \gamma(0)\\
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
&amp; k = 0: \rho(0) = \frac{\gamma(0)}{\gamma(0)} = 1\\
&amp; k = 1: \rho(1) = \frac{\gamma(1)}{\gamma(0)} = \phi_1\\
&amp; k = 2: \rho(2) = \frac{\gamma(2)}{\gamma(0)} = \phi_1 \frac{\gamma(1)}{\gamma(0)} \\
&amp; k = 3: \rho(3) = \frac{\gamma(3)}{\gamma(0)} = \phi_1 \frac{\gamma(2)}{\gamma(0)} \\
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
&amp; k = 0: \rho(0) = 1\\
&amp; k = 1: \rho(1) = \phi_1\\
&amp; k = 2: \rho(2) = \phi_1 \rho(1) \\
&amp; k = 3: \rho(3) = \phi_1  \rho(2) \\
\end{align}
\]</span> To compute <span class="math inline">\(\rho(3)\)</span> for example, you need to substitute for <span class="math inline">\(\rho(2)\)</span>:</p>
<p><span class="math display">\[
\rho(3) = \phi_1 (\phi_1 \rho(1)) = \phi_1 (\phi_1 (\phi_1)) = \phi_1^3
\]</span> More generally you obtain</p>
<p><span class="math display">\[
\rho(k) = \phi_1^{k}
\]</span> Lets see how this works for AR(3)</p>
<p><span class="math display">\[
y_t = \phi_1 y_{t - 1} + \phi_2y_{t - 2} + \phi_3 y_{t - 3} + e_t
\]</span></p>
<p>Multiply the whole equation by <span class="math inline">\(y_{t - k}\)</span> and take expectations on both sides</p>
<p><span class="math display">\[
y_{t - k}y_t = \phi_1 y_{t - k}y_{t - 1} + \phi_2 y_{t - k} y_{t - 2} + \phi_3 y_{t - k} y_{t - 3} + y_{t - k}e_t
\]</span></p>
<p><span class="math display">\[
E(y_{t - k}y_t) = \phi_1 E(y_{t - k}y_{t - 1}) + \phi_2 E(y_{t - k} y_{t - 2}) + \phi_3 E(y_{t - k} y_{t - 3}) + E(y_{t - k}e_t)
\]</span></p>
<p>Following the same reasoning as for the AR(1) process above and using the shorthand notation for the autocovariances:</p>
<p><span class="math display">\[
\gamma(k) = \phi_1\gamma(k - 1) + \phi_2 \gamma(k - 2) + \phi_3 \gamma(k - 3) + \unicode{x1D7D9}_{k = 0}\sigma^2
\]</span> Write it down for <span class="math inline">\(k = 0, 1, 2\)</span></p>
<p><span class="math display">\[
\begin{align}
&amp; k = 0: \gamma(0) = \phi_1\gamma(-1) + \phi_2\gamma(-2) + \phi_3 \gamma(-3) + \sigma^2 \\
&amp; k = 1: \gamma(1) = \phi_1\gamma(1 - 1) + \phi_2\gamma(1 -2) + \phi_3 \gamma(1 -3) \\
&amp; k = 2: \gamma(2) = \phi_1\gamma(2 - 1) + \phi_2\gamma(2 -2) + \phi_3 \gamma(2 -3) \\
\end{align}
\]</span></p>
<p>Simplify and use the symmetry of autocovariances</p>
<p><span class="math display">\[
\begin{align}
&amp; k = 0: \gamma(0) = \phi_1\gamma(1) + \phi_2\gamma(2) + \phi_3 \gamma(3) + \sigma^2 \\
&amp; k = 1: \gamma(1) = \phi_1\gamma(0) + \phi_2\gamma(1) + \phi_3 \gamma(2) \\
&amp; k = 2: \gamma(2) = \phi_1\gamma(1) + \phi_2\gamma(0) + \phi_3 \gamma(1) \\
\end{align}
\]</span></p>
<p>:::{exr-yule-walker-lecture}</p>
</section>
<section id="characteristic-roots-and-the-yule-walker-equations" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="characteristic-roots-and-the-yule-walker-equations"><span class="header-section-number">4.3</span> Characteristic Roots and the Yule-Walker equations</h2>
<p>A solution to one of the problems from the lecture slides. You are given the characteristic roots of a third order autoregressive process. The task in this exercise is to use these roots to find the first and second order autocorrelations of this process. So, the roots of the characteristic equation are: 0.8, 0.2, -0.5. Roots of what? Remember that the lag operator shifts a series (<a href="03-linear-difference-equations.html#def-lag-operator">Definition&nbsp;<span>3.1</span></a>):</p>
<p><span class="math display">\[
Ly_{t} = y_{t - 1}\\
Ly_{t - 1} = y_{t - 2}\\
L(L_{t}) = y_{t - 2}\\
L^2y_{t} = y_{t - 2}\\
L^3y_{t} = y_{t - 3}
\]</span> So you can express the AR(3) process in terms of its lag-polynomial:</p>
<p><span class="math display">\[
y_{t} = \phi_0 + \phi_{1}y_{t - 1} + \phi_2 y_{t - 2} + \phi_3 y_{t - 3} + e_t, \quad e_t \sim N(0, \sigma^2)
\]</span> <span class="math display">\[
\begin{align}
y_{t} &amp; = \phi_0 + \phi_1 Ly_{t} + \phi_2 L^2y_{t} + \phi_3 L^3 y_{t} + e_t\\
y_{t}(\underbrace{L^0 - \phi_1 L - \phi_2 L^2 - \phi_3 L^3}_{\text{lag polynomial}}) &amp; = \phi_0 + e_t
\end{align}
\]</span> The characteristic equation is derived from the lag-polynomial as follows:</p>
<p><span class="math display">\[
\begin{align}
\lambda^{3 - 0} - \phi_1\lambda^{3 - 1} - \phi_2 \lambda^{3 - 2} - \phi_3 \lambda ^ {3 - 3} &amp; = 0\\
\lambda^{3} - \phi_1\lambda^{2} - \phi_2 \lambda - \phi_3 &amp; = 0
\end{align}
\]</span> The roots of the characteristic polynomial determine whether the process is stationary or not. If the roots of this equation are less than 1 in absolute value then the process is stationary.</p>
<p>If we know that the roots of this equation are</p>
<p><span class="math display">\[
\lambda_1^* = 0.8, \lambda_2^* = 0.2, \lambda_3^* = -0.5
\]</span> <span class="math display">\[
\lambda^{3} - \phi_1\lambda^{2} - \phi_2 \lambda - \phi_3 = (\lambda - \lambda_{1}^*)(\lambda - \lambda_2^*)(\lambda - \lambda_3^*) = 0
\]</span> <span class="math display">\[
\begin{align}
(\lambda - \lambda_{1}^*)(\lambda - \lambda_2^*)(\lambda - \lambda_3^*) = \\
(\lambda - 0.8)(\lambda - 0.2)(\lambda + 0.5) = \\
\left[\lambda^2 - \lambda + 0.16\right](\lambda + 0.5) = \\
\lambda^3 - \lambda^2 + 0.16\lambda + 0.5\lambda^2 - 0.5\lambda + 0.08
\end{align}
\]</span></p>
<p><span class="math display">\[
\lambda^{3} - \phi_1\lambda^{2} - \phi_2 \lambda - \phi_3\\
\lambda^3 -0.5\lambda^2 -0.34\lambda + 0.08
\]</span> So we have now recovered the process coefficients from the roots of the characteristic equation.</p>
<p><span class="math display">\[
\begin{align}
\phi_1 = 0.5\\
\phi_2 = 0.34\\
\phi_3 = -0.08
\end{align}
\]</span> <span class="math display">\[
\begin{align}
y_{t} &amp; = \phi_0 + \phi_{1}y_{t - 1} + \phi_2 y_{t - 2} + \phi_3 y_{t - 3} + e_t\\
y_{t} &amp; = \phi_0 + 0.5y_{t - 1} + 0.34y_{t - 2} - 0.08 y_{t - 3} + e_t
\end{align}
\]</span> Now we can calculate</p>
<p>First order autocorrelation: <span class="math display">\[
\rho(y_{t}, y_{t - 1}) = \rho_1 = \frac{Cov(y_{t}, y_{t - 1})}{Var(y_{t})}
\]</span> The Yule-Walker equations connect the autocorrelations (and autocovariances) and the model coefficients.</p>
<p><span class="math display">\[
\begin{align}
\rho_1 &amp; = \phi_1 \rho_0 + \phi_2\rho_1 + \ldots + \phi_R\rho_{R - 1}\\
\rho_2  &amp; = \phi_1 \rho_1 + \phi_2 + \ldots + \phi_R \rho_{R - 2} \\
\vdots\\
\rho_{R - 1}  &amp; = \phi_1 \rho_{R - 1} + \phi_2\rho_{R - 2} + \ldots + \phi_R\rho_0
\end{align}
\]</span> In the case of an AR(3)</p>
<p><span class="math display">\[
\begin{align}
\rho_1 &amp; = \phi_1 + \phi_2 \rho_1 + \phi_3 \rho_2\\
\rho_{2} &amp; = \phi_{1}\rho_{2 - 1} + \phi_2 \rho_{2 - 2} + \phi_3\rho_{3 - 2}\\
\end{align}
\]</span> Keep in mind that</p>
<p><span class="math display">\[
\rho(k) = \rho(-k)
\]</span></p>
<p><span class="math display">\[
\begin{align}
\rho_1 &amp; = \phi_1 + \phi_2 \rho_1 + \phi_3 \rho_2\\
\rho_{2} &amp; = \phi_{1}\rho_{1} + \phi_2 \rho_{0} + \phi_3\rho_{1}\\
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
\rho_1 = 0.5 + 0.34 \rho_1 - 0.08 \rho_2\\
\rho_2 = 0.5\rho_1 + 0.34 - 0.08\rho_1\\
\end{align}
\]</span> This is a system of two unknowns and two equations. Its solution is left as an exercise.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-linear-difference-equations.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear Difference Equations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-Model-Fitting.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ARIMA Modeling (1)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>